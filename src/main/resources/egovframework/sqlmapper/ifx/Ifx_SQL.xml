<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.gocle.ifx.service.impl.IfxMapper">

	<sql id="list-where">
	    
	</sql>
	
	<select id="getOjtAunuriSubjectLessonList" parameterType="kr.co.gocle.ifx.vo.AunuriMemberVO" resultType="kr.co.gocle.ifx.vo.AunuriSubjectVO">
		/**	kr.co.gocle.ifx.service.impl.IfxMapper.getOjtAunuriSubjectLessonList	*/
	    <!-- <![CDATA[
			  select
			      sub.SUBJECT_TRANING_TYPE AS subjectTraningType,
				  sub.YYYY AS year,
			      sub.TERM AS term,
			      sub.SUBJECT_CODE AS subjectCode,
			      sub.CLASS AS subClass,
			      sub.SUBJECT_NAME AS subjectName,
			      sub.SUBJECT_TYPE AS subjectType,
			      sub.ONLINE_TYPE AS onlineType
			  from lms_subject sub,
			  lms_lesson les
			  where 1 = 1
			  and sub.YYYY = les.YYYY
			  and sub.TERM = les.TERM
			  and sub.SUBJECT_CODE = les.SUBJECT_CODE
			  and sub.CLASS = les.CLASS
			  and sub.SUBJECT_TRANING_TYPE = 'OJT'
			  and sub.DELETE_YN = 'N'
			  and les.DELETE_YN = 'N'
			  and les.MEM_SEQ = #{sessionMemSeq}
			  
			   AND 
		       (
		         SUB.YYYY, 
		         SUB.TERM
		       ) 
		       IN (SELECT H.* FROM
		       (SELECT HAK.YYYY,
		              HAK.TERM 
		         FROM HAK_SCHEDULE HAK 
		        WHERE TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN HAK.START_DATE AND HAK.END_DATE
		        AND ROWNUM = 1  ) H
		       ) 
		ORDER BY SUB.SUBJECT_NAME
	    ]]> -->
	    
	    <![CDATA[
			  select
			      sub.SUBJECT_TRANING_TYPE AS subjectTraningType,
				  sub.YYYY AS year,
			      sub.TERM AS term,
			      sub.SUBJECT_CODE AS subjectCode,
			      sub.CLASS AS subClass,
			      sub.SUBJECT_NAME AS subjectName,
			      sub.SUBJECT_TYPE AS subjectType,
			      sub.ONLINE_TYPE AS onlineType
			  from lms_subject sub,
			  lms_lesson les
			  where 1 = 1
			  and sub.YYYY = les.YYYY
			  and sub.TERM = les.TERM
			  and sub.SUBJECT_CODE = les.SUBJECT_CODE
			  and sub.CLASS = les.CLASS
			  and sub.SUBJECT_TRANING_TYPE = 'OJT'
			  and sub.DELETE_YN = 'N'
			  and les.DELETE_YN = 'N'
			  and les.MEM_SEQ = #{sessionMemSeq}
			  
			   AND 
		       (
		         SUB.YYYY, 
		         SUB.TERM
		       ) 
		       IN (SELECT H.* FROM
		       (SELECT HAK.YYYY,
		              HAK.TERM 
		         FROM HAK_SCHEDULE HAK 
		        WHERE TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN TO_CHAR(TO_DATE(HAK.START_DATE,'YYYYMMDD')-5,'YYYYMMDD') AND TO_CHAR(TO_DATE(HAK.END_DATE,'YYYYMMDD')+14,'YYYYMMDD')
		         ) H
		       ) 
		ORDER BY SUB.SUBJECT_NAME
	    ]]>
	    			
	</select>
	
	<select id="getOffJtAunuriSubjectLessonList" parameterType="kr.co.gocle.ifx.vo.AunuriMemberVO" resultType="kr.co.gocle.ifx.vo.AunuriSubjectVO">
		/**	kr.co.gocle.ifx.service.impl.IfxMapper.getOffJtAunuriSubjectLessonList	*/
	    <!-- <![CDATA[
			select
			      sub.SUBJECT_TRANING_TYPE AS subjectTraningType,
				  sub.YYYY AS year,
			      sub.TERM AS term,
			      sub.SUBJECT_CODE AS subjectCode,
			      sub.CLASS AS subClass,
			      sub.SUBJECT_NAME AS subjectName,
			      sub.SUBJECT_TYPE AS subjectType,
			      
			        CASE
			       		WHEN sub.ONLINE_TYPE IN ('104','105') THEN 'FLIPPED'
			       		WHEN sub.ONLINE_TYPE = '102' THEN 'BLENDED'
			       		WHEN sub.ONLINE_TYPE = '101' THEN 'ONLINE'
			         ELSE  'NONE'
			   	 END onlineType
			      
			  from lms_subject sub,
			  lms_lesson les
			  where 1 = 1
			  and sub.YYYY = les.YYYY
			  and sub.TERM = les.TERM
			  and sub.SUBJECT_CODE = les.SUBJECT_CODE
			  and sub.CLASS = les.CLASS
			  and sub.SUBJECT_TRANING_TYPE = 'OFF'
			  and sub.DELETE_YN = 'N'
			  and les.DELETE_YN = 'N'
			  and les.MEM_SEQ = #{sessionMemSeq}
			   AND 
		       (
		         SUB.YYYY, 
		         SUB.TERM
		       ) 
		       IN (SELECT H.* FROM
		       (SELECT HAK.YYYY,
		              HAK.TERM 
		         FROM HAK_SCHEDULE HAK 
		        WHERE TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN HAK.START_DATE AND HAK.END_DATE
		        AND ROWNUM = 1 ) H
		       ) 
		ORDER BY SUB.SUBJECT_NAME
	    ]]> -->
	    
	    <![CDATA[
			select
			      sub.SUBJECT_TRANING_TYPE AS subjectTraningType,
				  sub.YYYY AS year,
			      sub.TERM AS term,
			      sub.SUBJECT_CODE AS subjectCode,
			      sub.CLASS AS subClass,
			      sub.SUBJECT_NAME AS subjectName,
			      sub.SUBJECT_TYPE AS subjectType,
			      
			        CASE
			       		WHEN sub.ONLINE_TYPE IN ('104','105') THEN 'FLIPPED'
			       		WHEN sub.ONLINE_TYPE = '102' THEN 'BLENDED'
			       		WHEN sub.ONLINE_TYPE = '101' THEN 'ONLINE'
			         ELSE  'NONE'
			   	 END onlineType
			      
			  from lms_subject sub,
			  lms_lesson les
			  where 1 = 1
			  and sub.YYYY = les.YYYY
			  and sub.TERM = les.TERM
			  and sub.SUBJECT_CODE = les.SUBJECT_CODE
			  and sub.CLASS = les.CLASS
			  and sub.SUBJECT_TRANING_TYPE = 'OFF'
			  and sub.DELETE_YN = 'N'
			  and les.DELETE_YN = 'N'
			  and les.MEM_SEQ = #{sessionMemSeq}
			   AND 
		       (
		         SUB.YYYY, 
		         SUB.TERM
		       ) 
		       IN (SELECT H.* FROM
		       (SELECT HAK.YYYY,
		              HAK.TERM 
		         FROM HAK_SCHEDULE HAK 
		        WHERE TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN TO_CHAR(TO_DATE(HAK.START_DATE,'YYYYMMDD')-5,'YYYYMMDD') AND TO_CHAR(TO_DATE(HAK.END_DATE,'YYYYMMDD')+14,'YYYYMMDD')
		         ) H
		       ) 
		ORDER BY SUB.SUBJECT_NAME
	    ]]>

	</select>
	
	
	
		<select id="getOjtAunuriSubjectInsMappingList" parameterType="kr.co.gocle.ifx.vo.AunuriMemberVO" resultType="kr.co.gocle.ifx.vo.AunuriSubjectVO">
		 /**	kr.co.gocle.ifx.service.impl.IfxMapper.getOjtAunuriSubjectInsMappingList	*/
		<!--	 select
			      sub.SUBJECT_TRANING_TYPE AS subjectTraningType,
				  sub.YYYY AS year,
			      sub.TERM AS term,
			      sub.SUBJECT_CODE AS subjectCode,
			      sub.SUBJECT_NAME AS subjectName,
			      min(sub.class) AS subClass,
			      sub.SUBJECT_TYPE AS subjectType,
			      sub.ONLINE_TYPE AS onlineType,
			       (
			      SELECT FN_GETTRANING_PROCESS_NAME(LTP.TRANING_PROCESS_ID) FROM LMS_TRANING_PROCESS_MAPPING LTP
			      	WHERE LTP.DELETE_YN = 'N'
			      	AND LTP.YYYY = SUB.YYYY
			      	AND LTP.TERM = SUB.TERM
			      	AND LTP.SUBJECT_CODE = SUB.SUBJECT_CODE
			      	AND LTP.CLASS = SUB.CLASS
			      	AND ROWNUM = 1
			      ) AS TRANING_PROCESS_NAME ,
			      (
			      SELECT COUNT(*) FROM LMS_LESSON LES
			      	INNER JOIN COM_MEMBER MEM
				      	ON LES.MEM_SEQ = MEM.MEM_SEQ
				     	AND MEM.DELETE_YN = 'N' 
				      	AND MEM.OUT_YN = 'N'
				      	AND MEM.STD_HAK_STATUS = '1'
			      	WHERE LES.DELETE_YN = 'N'
			      	AND LES.LEC_STATUS = 'A'
			      	AND LES.YYYY = SUB.YYYY
			      	AND LES.TERM = SUB.TERM
			      	AND LES.SUBJECT_CODE = SUB.SUBJECT_CODE
			      	
			      	AND 
		              (
		                  LES.YYYY,
		                  LES.TERM,
		                  LES.SUBJECT_CODE,
		                  LES.CLASS
		              ) 
		              IN 
		              (SELECT YYYY,
		                     TERM,
		                     SUBJECT_CODE,
		                     CLASS 
		                FROM LMS_SUBJ_INS_MAPPING 
		               WHERE MEM_SEQ = #{sessionMemSeq}
		              ) 
			      	
			      ) AS STU_CNT
			  from lms_subject sub,
			  lms_subj_ins_mapping ins
			  where 1 = 1
			  and sub.YYYY = ins.YYYY
			  and sub.TERM = ins.TERM
			  and sub.SUBJECT_CODE = ins.SUBJECT_CODE
			  and sub.CLASS = ins.CLASS
			  and sub.SUBJECT_TRANING_TYPE = 'OJT'
			  and sub.DELETE_YN = 'N'
			  and ins.DELETE_YN = 'N'
			  and ins.MEM_SEQ = #{sessionMemSeq}
			   AND 
		       (
		         SUB.YYYY, 
		         SUB.TERM
		       ) 
		       IN (SELECT H.* FROM
		       (SELECT HAK.YYYY,
		              HAK.TERM 
		         FROM HAK_SCHEDULE HAK 
		        WHERE TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN HAK.START_DATE AND HAK.END_DATE
		        AND ROWNUM = 1 ) H
		       ) 
		GROUP BY sub.SUBJECT_TRANING_TYPE ,
				   sub.YYYY ,
			      sub.TERM ,
			      sub.SUBJECT_CODE ,
			      sub.SUBJECT_NAME ,
			      sub.SUBJECT_TYPE ,
			      sub.ONLINE_TYPE
			      
		ORDER BY SUB.SUBJECT_NAME,SUB.SUBJECT_CODE	 -->
		
			 select
			      sub.SUBJECT_TRANING_TYPE AS subjectTraningType,
				  sub.YYYY AS year,
			      sub.TERM AS term,
			      sub.SUBJECT_CODE AS subjectCode,
			      sub.SUBJECT_NAME AS subjectName,
			      min(sub.class) AS subClass,
			      sub.SUBJECT_TYPE AS subjectType,
			      sub.ONLINE_TYPE AS onlineType,
			      <!--  (
			      SELECT FN_GETTRANING_PROCESS_NAME(LTP.TRANING_PROCESS_ID) FROM LMS_TRANING_PROCESS_MAPPING LTP
			      	WHERE LTP.DELETE_YN = 'N'
			      	AND LTP.YYYY = SUB.YYYY
			      	AND LTP.TERM = SUB.TERM
			      	AND LTP.SUBJECT_CODE = SUB.SUBJECT_CODE
			      	AND LTP.CLASS = SUB.CLASS
			      	AND ROWNUM = 1
			      ) AS TRANING_PROCESS_NAME , -->
			      (
			      SELECT COUNT(*) FROM LMS_LESSON LES
			      	INNER JOIN COM_MEMBER MEM
				      	ON LES.MEM_SEQ = MEM.MEM_SEQ
				     	AND MEM.DELETE_YN = 'N' 
				      	AND MEM.OUT_YN = 'N'
				      	AND MEM.STD_HAK_STATUS = '1'
			      	WHERE LES.DELETE_YN = 'N'
			      	AND LES.LEC_STATUS = 'A'
			      	AND LES.YYYY = SUB.YYYY
			      	AND LES.TERM = SUB.TERM
			      	AND LES.SUBJECT_CODE = SUB.SUBJECT_CODE
			      	
			      	AND 
		              (
		                  LES.YYYY,
		                  LES.TERM,
		                  LES.SUBJECT_CODE,
		                  LES.CLASS
		              ) 
		              IN 
		              (SELECT YYYY,
		                     TERM,
		                     SUBJECT_CODE,
		                     CLASS 
		                FROM LMS_SUBJ_INS_MAPPING 
		               WHERE MEM_SEQ = #{sessionMemSeq}
		              ) 
			      	
			      ) AS STU_CNT
			  from lms_subject sub,
			  lms_subj_ins_mapping ins
			  where 1 = 1
			  and sub.YYYY = ins.YYYY
			  and sub.TERM = ins.TERM
			  and sub.SUBJECT_CODE = ins.SUBJECT_CODE
			  and sub.CLASS = ins.CLASS
			  and sub.SUBJECT_TRANING_TYPE = 'OJT'
			  and sub.DELETE_YN = 'N'
			  and ins.DELETE_YN = 'N'
			  and ins.MEM_SEQ = #{sessionMemSeq}
			   AND 
		       (
		         SUB.YYYY, 
		         SUB.TERM
		       ) 
		       IN (SELECT H.* FROM
		       (SELECT HAK.YYYY,
		              HAK.TERM 
		         FROM HAK_SCHEDULE HAK 
		        WHERE TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN TO_CHAR(TO_DATE(HAK.START_DATE,'YYYYMMDD')-5,'YYYYMMDD') AND TO_CHAR(TO_DATE(HAK.END_DATE,'YYYYMMDD')+14,'YYYYMMDD')
		         ) H
		       ) 
		GROUP BY sub.SUBJECT_TRANING_TYPE ,
				   sub.YYYY ,
			      sub.TERM ,
			      sub.SUBJECT_CODE ,
			      sub.SUBJECT_NAME ,
			      sub.SUBJECT_TYPE ,
			      sub.ONLINE_TYPE
			      
		ORDER BY SUB.SUBJECT_NAME,SUB.SUBJECT_CODE	    			
 
	</select>
	
	<select id="getOjtAunuriSubjectApproValInsMappingList" parameterType="kr.co.gocle.ifx.vo.AunuriMemberVO" resultType="kr.co.gocle.ifx.vo.AunuriSubjectVO">
		/**	kr.co.gocle.ifx.service.impl.IfxMapper.getOjtAunuriSubjectInsMappingList	*/
			 select
			      sub.SUBJECT_TRANING_TYPE AS subjectTraningType,
				  sub.YYYY AS year,
			      sub.TERM AS term,
			      sub.SUBJECT_CODE AS subjectCode,
			      sub.SUBJECT_NAME AS subjectName,
			      min(sub.class) AS subClass,
			      sub.SUBJECT_TYPE AS subjectType,
			      sub.ONLINE_TYPE AS onlineType,
			      (
			      SELECT COUNT(*) FROM LMS_LESSON LES
			      	INNER JOIN COM_MEMBER MEM
				      	ON LES.MEM_SEQ = MEM.MEM_SEQ
				     	AND MEM.DELETE_YN = 'N' 
				      	AND MEM.OUT_YN = 'N'
				      	AND MEM.STD_HAK_STATUS = '1'
			      	WHERE LES.DELETE_YN = 'N'
			      	AND LES.LEC_STATUS = 'A'
			      	AND LES.YYYY = SUB.YYYY
			      	AND LES.TERM = SUB.TERM
			      	AND LES.SUBJECT_CODE = SUB.SUBJECT_CODE
			      	
			      	AND 
		              (
		                  LES.YYYY,
		                  LES.TERM,
		                  LES.SUBJECT_CODE,
		                  LES.CLASS
		              ) 
		              IN 
		              (SELECT YYYY,
		                     TERM,
		                     SUBJECT_CODE,
		                     CLASS 
		                FROM LMS_SUBJ_INS_MAPPING 
		               WHERE MEM_SEQ = #{sessionMemSeq}
		              ) 
			      	
			      ) AS STU_CNT
			  from lms_subject sub,
			  lms_subj_ins_mapping ins
			  where 1 = 1
			  and sub.YYYY = ins.YYYY
			  and sub.TERM = ins.TERM
			  and sub.SUBJECT_CODE = ins.SUBJECT_CODE
			  and sub.CLASS = ins.CLASS
			  and sub.SUBJECT_TRANING_TYPE = 'OJT'
			  and sub.DELETE_YN = 'N'
			  and ins.DELETE_YN = 'N'
			  and ins.MEM_SEQ = #{sessionMemSeq}
			   and ins.yyyy = #{yyyy}
			   and ins.term = #{term} 
		      
		GROUP BY sub.SUBJECT_TRANING_TYPE ,
				   sub.YYYY ,
			      sub.TERM ,
			      sub.SUBJECT_CODE ,
			      sub.SUBJECT_NAME ,
			      sub.SUBJECT_TYPE ,
			      sub.ONLINE_TYPE
			      
		ORDER BY SUB.SUBJECT_NAME,SUB.SUBJECT_CODE	    			
 
	</select>
	
	<select id="getOjtAunuriSubjectInsClassMappingList" parameterType="kr.co.gocle.ifx.vo.AunuriMemberVO" resultType="kr.co.gocle.ifx.vo.AunuriSubjectVO">
		/**	kr.co.gocle.ifx.service.impl.IfxMapper.getOjtAunuriSubjectInsClassMappingList	*/
	    <!-- <![CDATA[
			 select
			      sub.SUBJECT_TRANING_TYPE AS subjectTraningType,
				  sub.YYYY AS year,
			      sub.TERM AS term,
			      sub.SUBJECT_CODE AS subjectCode,
			      sub.CLASS AS subClass,
			      sub.SUBJECT_NAME AS subjectName,
			      sub.SUBJECT_TYPE AS subjectType,
			      sub.ONLINE_TYPE AS onlineType,
			      (
			      SELECT COUNT(*) FROM LMS_LESSON LES
			      	INNER JOIN COM_MEMBER MEM
				      	ON LES.MEM_SEQ = MEM.MEM_SEQ
				     	AND MEM.DELETE_YN = 'N' 
				      	AND MEM.OUT_YN = 'N'
			      	WHERE LES.DELETE_YN = 'N'
			      	AND LES.LEC_STATUS = 'A'
			      	AND LES.YYYY = SUB.YYYY
			      	AND LES.TERM = SUB.TERM
			      	AND LES.SUBJECT_CODE = SUB.SUBJECT_CODE
			      ) AS STU_CNT
			  from lms_subject sub,
			  lms_subj_ins_mapping ins
			  where 1 = 1
			  and sub.YYYY = ins.YYYY
			  and sub.TERM = ins.TERM
			  and sub.SUBJECT_CODE = ins.SUBJECT_CODE
			  and sub.CLASS = ins.CLASS
			  and sub.SUBJECT_TRANING_TYPE = 'OJT'
			  and sub.DELETE_YN = 'N'
			  and ins.DELETE_YN = 'N'
			  and ins.MEM_SEQ = #{sessionMemSeq}
			   AND 
		       (
		         SUB.YYYY, 
		         SUB.TERM
		       ) 
		       IN (SELECT H.* FROM
		       (SELECT HAK.YYYY,
		              HAK.TERM 
		         FROM HAK_SCHEDULE HAK 
		        WHERE TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN HAK.START_DATE AND HAK.END_DATE
		        AND ROWNUM = 1  ) H
		       ) 
			      
		ORDER BY SUB.SUBJECT_NAME, SUB.CLASS	    			
	    ]]> -->
	    
	    <![CDATA[
			 select
			      sub.SUBJECT_TRANING_TYPE AS subjectTraningType,
				  sub.YYYY AS year,
			      sub.TERM AS term,
			      sub.SUBJECT_CODE AS subjectCode,
			      sub.CLASS AS subClass,
			      sub.SUBJECT_NAME AS subjectName,
			      sub.SUBJECT_TYPE AS subjectType,
			      sub.ONLINE_TYPE AS onlineType,
			      (
			      SELECT COUNT(*) FROM LMS_LESSON LES
			      	INNER JOIN COM_MEMBER MEM
				      	ON LES.MEM_SEQ = MEM.MEM_SEQ
				     	AND MEM.DELETE_YN = 'N' 
				      	AND MEM.OUT_YN = 'N'
			      	WHERE LES.DELETE_YN = 'N'
			      	AND LES.LEC_STATUS = 'A'
			      	AND LES.YYYY = SUB.YYYY
			      	AND LES.TERM = SUB.TERM
			      	AND LES.SUBJECT_CODE = SUB.SUBJECT_CODE
			      ) AS STU_CNT
			  from lms_subject sub,
			  lms_subj_ins_mapping ins
			  where 1 = 1
			  and sub.YYYY = ins.YYYY
			  and sub.TERM = ins.TERM
			  and sub.SUBJECT_CODE = ins.SUBJECT_CODE
			  and sub.CLASS = ins.CLASS
			  and sub.SUBJECT_TRANING_TYPE = 'OJT'
			  and sub.DELETE_YN = 'N'
			  and ins.DELETE_YN = 'N'
			  and ins.MEM_SEQ = #{sessionMemSeq}
			   AND 
		       (
		         SUB.YYYY, 
		         SUB.TERM
		       ) 
		       IN (SELECT H.* FROM
		       (SELECT HAK.YYYY,
		              HAK.TERM 
		         FROM HAK_SCHEDULE HAK 
		        WHERE TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN TO_CHAR(TO_DATE(HAK.START_DATE,'YYYYMMDD')-5,'YYYYMMDD') AND TO_CHAR(TO_DATE(HAK.END_DATE,'YYYYMMDD')+14,'YYYYMMDD')
		        ) H
		       ) 
			      
		ORDER BY SUB.SUBJECT_NAME, SUB.CLASS	    			
	    ]]>

	</select>
	
	<select id="getOffJtAunuriSubjectInsMappingList" parameterType="kr.co.gocle.ifx.vo.AunuriMemberVO" resultType="kr.co.gocle.ifx.vo.AunuriSubjectVO">
		/**	kr.co.gocle.ifx.service.impl.IfxMapper.getOffJtAunuriSubjectInsMappingList	*/
	    <!-- <![CDATA[
			select
			      sub.SUBJECT_TRANING_TYPE AS subjectTraningType,
				  sub.YYYY AS year,
			      sub.TERM AS term,
			      sub.SUBJECT_CODE AS subjectCode,
			      sub.CLASS AS subClass,
			      sub.SUBJECT_NAME AS subjectName,
			      sub.SUBJECT_TYPE AS subjectType,
			      
			      
			      CASE
			       		WHEN sub.ONLINE_TYPE IN ('104','105') THEN 'FLIPPED'
			       		WHEN sub.ONLINE_TYPE = '102' THEN 'BLENDED'
			       		WHEN sub.ONLINE_TYPE = '101' THEN 'ONLINE'
			         ELSE  'NONE'
			   	 END onlineType,
			      
			        (
			      SELECT COUNT(*) FROM LMS_LESSON LES
			      	INNER JOIN COM_MEMBER MEM
				      	ON LES.MEM_SEQ = MEM.MEM_SEQ
				     	AND MEM.DELETE_YN = 'N' 
				      	AND MEM.OUT_YN = 'N'
				      	AND MEM.STD_HAK_STATUS = '1'
			      	WHERE LES.DELETE_YN = 'N'
			      	AND LES.LEC_STATUS = 'A'
			      	AND LES.YYYY = SUB.YYYY
			      	AND LES.TERM = SUB.TERM
			      	AND LES.SUBJECT_CODE = SUB.SUBJECT_CODE
			      	AND LES.CLASS = SUB.CLASS
			      ) AS STU_CNT
			  from lms_subject sub,
			  lms_subj_ins_mapping ins
			  where 1 = 1
			  and sub.YYYY = ins.YYYY
			  and sub.TERM = ins.TERM
			  and sub.SUBJECT_CODE = ins.SUBJECT_CODE
			  and sub.CLASS = ins.CLASS
			  and sub.SUBJECT_TRANING_TYPE = 'OFF'
			  and sub.DELETE_YN = 'N'
			  and ins.DELETE_YN = 'N'
			  and ins.MEM_SEQ = #{sessionMemSeq}
			  
			   AND 
		       (
		         SUB.YYYY, 
		         SUB.TERM
		       ) 
		       IN  (SELECT H.* FROM
		       (SELECT HAK.YYYY,
		              HAK.TERM 
		         FROM HAK_SCHEDULE HAK 
		        WHERE TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN HAK.START_DATE AND HAK.END_DATE
		        AND ROWNUM = 1 ) H
		       ) 
		ORDER BY SUB.SUBJECT_NAME,SUB.SUBJECT_CODE
	    ]]> -->
	    
	    <![CDATA[
			select
			      sub.SUBJECT_TRANING_TYPE AS subjectTraningType,
				  sub.YYYY AS year,
			      sub.TERM AS term,
			      sub.SUBJECT_CODE AS subjectCode,
			      sub.CLASS AS subClass,
			      sub.SUBJECT_NAME AS subjectName,
			      sub.SUBJECT_TYPE AS subjectType,
			      
			      
			      CASE
			       		WHEN sub.ONLINE_TYPE IN ('104','105') THEN 'FLIPPED'
			       		WHEN sub.ONLINE_TYPE = '102' THEN 'BLENDED'
			       		WHEN sub.ONLINE_TYPE = '101' THEN 'ONLINE'
			         ELSE  'NONE'
			   	 END onlineType,
			      
			        (
			      SELECT COUNT(*) FROM LMS_LESSON LES
			      	INNER JOIN COM_MEMBER MEM
				      	ON LES.MEM_SEQ = MEM.MEM_SEQ
				     	AND MEM.DELETE_YN = 'N' 
				      	AND MEM.OUT_YN = 'N'
				      	AND MEM.STD_HAK_STATUS = '1'
			      	WHERE LES.DELETE_YN = 'N'
			      	AND LES.LEC_STATUS = 'A'
			      	AND LES.YYYY = SUB.YYYY
			      	AND LES.TERM = SUB.TERM
			      	AND LES.SUBJECT_CODE = SUB.SUBJECT_CODE
			      	AND LES.CLASS = SUB.CLASS
			      ) AS STU_CNT
			  from lms_subject sub,
			  lms_subj_ins_mapping ins
			  where 1 = 1
			  and sub.YYYY = ins.YYYY
			  and sub.TERM = ins.TERM
			  and sub.SUBJECT_CODE = ins.SUBJECT_CODE
			  and sub.CLASS = ins.CLASS
			  and sub.SUBJECT_TRANING_TYPE = 'OFF'
			  and sub.DELETE_YN = 'N'
			  and ins.DELETE_YN = 'N'
			  and ins.MEM_SEQ = #{sessionMemSeq}
			  
			   AND 
		       (
		         SUB.YYYY, 
		         SUB.TERM
		       ) 
		       IN  (SELECT H.* FROM
		       (SELECT HAK.YYYY,
		              HAK.TERM 
		         FROM HAK_SCHEDULE HAK 
		        WHERE TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN TO_CHAR(TO_DATE(HAK.START_DATE,'YYYYMMDD')-5,'YYYYMMDD') AND TO_CHAR(TO_DATE(HAK.END_DATE,'YYYYMMDD')+14,'YYYYMMDD')
		         ) H
		       ) 
		ORDER BY SUB.SUBJECT_NAME,SUB.SUBJECT_CODE
	    ]]>

	</select>
	
	<select id="getOjtAunuriSubjectTutMappingList" parameterType="kr.co.gocle.ifx.vo.AunuriMemberVO" resultType="kr.co.gocle.ifx.vo.AunuriSubjectVO">
		/**	kr.co.gocle.ifx.service.impl.IfxMapper.getOjtAunuriSubjectTutMappingList	*/
	    <!-- <![CDATA[
			select
			      sub.SUBJECT_TRANING_TYPE AS subjectTraningType,
				  sub.YYYY AS year,
			      sub.TERM AS term,
			      sub.SUBJECT_CODE AS subjectCode,
			      sub.CLASS AS subClass,
			      sub.SUBJECT_NAME AS subjectName,
			      sub.SUBJECT_TYPE AS subjectType,
			      sub.ONLINE_TYPE AS onlineType,
			      (
			      SELECT COUNT(*) FROM LMS_LESSON LES
			      	INNER JOIN COM_MEMBER MEM
				      	ON LES.MEM_SEQ = MEM.MEM_SEQ
				     	AND MEM.DELETE_YN = 'N' 
				      	AND MEM.OUT_YN = 'N'
			      	WHERE LES.DELETE_YN = 'N'
			      	AND LES.LEC_STATUS = 'A'
			      	AND LES.YYYY = SUB.YYYY
			      	AND LES.TERM = SUB.TERM
			      	AND LES.SUBJECT_CODE = SUB.SUBJECT_CODE
			      	AND LES.CLASS = SUB.CLASS
			      ) AS STU_CNT
			  from lms_subject sub,
			  lms_subj_tut_mapping tut
			  where 1 = 1
			  and sub.YYYY = tut.YYYY
			  and sub.TERM = tut.TERM
			  and sub.SUBJECT_CODE = tut.SUBJECT_CODE
			  and sub.CLASS = tut.CLASS
			  and sub.DELETE_YN = 'N'
			  and tut.DELETE_YN = 'N'
			  and tut.MEM_SEQ = #{sessionMemSeq}
			  
			   AND 
		       (
		         SUB.YYYY, 
		         SUB.TERM
		       ) 
		       IN (SELECT H.* FROM
		       (SELECT HAK.YYYY,
		              HAK.TERM 
		         FROM HAK_SCHEDULE HAK 
		        WHERE TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN HAK.START_DATE AND HAK.END_DATE
		        AND ROWNUM = 1 ) H
		       ) 
		ORDER BY SUB.SUBJECT_NAME
	    ]]> -->
	    
	    <![CDATA[
			select
			      sub.SUBJECT_TRANING_TYPE AS subjectTraningType,
				  sub.YYYY AS year,
			      sub.TERM AS term,
			      sub.SUBJECT_CODE AS subjectCode,
			      sub.CLASS AS subClass,
			      sub.SUBJECT_NAME AS subjectName,
			      sub.SUBJECT_TYPE AS subjectType,
			      sub.ONLINE_TYPE AS onlineType,
			      (
			      SELECT COUNT(*) FROM LMS_LESSON LES
			      	INNER JOIN COM_MEMBER MEM
				      	ON LES.MEM_SEQ = MEM.MEM_SEQ
				     	AND MEM.DELETE_YN = 'N' 
				      	AND MEM.OUT_YN = 'N'
			      	WHERE LES.DELETE_YN = 'N'
			      	AND LES.LEC_STATUS = 'A'
			      	AND LES.YYYY = SUB.YYYY
			      	AND LES.TERM = SUB.TERM
			      	AND LES.SUBJECT_CODE = SUB.SUBJECT_CODE
			      	AND LES.CLASS = SUB.CLASS
			      ) AS STU_CNT
			  from lms_subject sub,
			  lms_subj_tut_mapping tut
			  where 1 = 1
			  and sub.YYYY = tut.YYYY
			  and sub.TERM = tut.TERM
			  and sub.SUBJECT_CODE = tut.SUBJECT_CODE
			  and sub.CLASS = tut.CLASS
			  and sub.DELETE_YN = 'N'
			  and tut.DELETE_YN = 'N'
			  and tut.MEM_SEQ = #{sessionMemSeq}
			  
			   AND 
		       (
		         SUB.YYYY, 
		         SUB.TERM
		       ) 
		       IN (SELECT H.* FROM
		       (SELECT HAK.YYYY,
		              HAK.TERM 
		         FROM HAK_SCHEDULE HAK 
		        WHERE TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN TO_CHAR(TO_DATE(HAK.START_DATE,'YYYYMMDD')-5,'YYYYMMDD') AND TO_CHAR(TO_DATE(HAK.END_DATE,'YYYYMMDD')+14,'YYYYMMDD')
		         ) H
		       ) 
		ORDER BY SUB.SUBJECT_NAME
	    ]]>

	</select>
	
	<select id="getOffJtAunuriSubjectCdpMappingList" parameterType="kr.co.gocle.ifx.vo.AunuriMemberVO" resultType="kr.co.gocle.ifx.vo.AunuriSubjectVO">
		/**	kr.co.gocle.ifx.service.impl.IfxMapper.getOffJtAunuriSubjectCdpMappingList	*/
	    <!-- <![CDATA[
			select
			      sub.SUBJECT_TRANING_TYPE AS subjectTraningType,
				  sub.YYYY AS year,
			      sub.TERM AS term,
			      sub.SUBJECT_CODE AS subjectCode,
			      sub.CLASS AS subClass,
			      sub.SUBJECT_NAME AS subjectName,
			      sub.SUBJECT_TYPE AS subjectType,
			      CASE
			       		WHEN sub.ONLINE_TYPE IN ('104','105') THEN 'FLIPPED'
			       		WHEN sub.ONLINE_TYPE = '102' THEN 'BLENDED'
			       		WHEN sub.ONLINE_TYPE = '101' THEN 'ONLINE'
			         ELSE  'NONE'
			   	 END onlineType,
			       (
			      SELECT SUM(1) FROM LMS_LESSON LES			      	 
			      	WHERE  EXISTS (SELECT 1 FROM COM_MEMBER MEM WHERE LES.MEM_SEQ = MEM.MEM_SEQ 
                          AND MEM.DELETE_YN = 'N' 
                          AND MEM.OUT_YN = 'N' )
                    AND LES.DELETE_YN = 'N'
			      	AND LES.LEC_STATUS = 'A'
			      	AND LES.YYYY = SUB.YYYY
			      	AND LES.TERM = SUB.TERM
			      	AND LES.SUBJECT_CODE = SUB.SUBJECT_CODE
			      	AND LES.CLASS = SUB.CLASS
			      ) AS STU_CNT
			  from lms_subject sub,
			  lms_dept_cdp_mapping cdp
			  where 1 = 1
			  and sub.department_no = cdp.dept_no
			  and sub.SUBJECT_TRANING_TYPE = 'OFF'
			  and sub.DELETE_YN = 'N'
			  and cdp.MEM_SEQ = #{sessionMemSeq}
			  
			   AND 
		       (
		         SUB.YYYY, 
		         SUB.TERM
		       ) 
		       IN (SELECT H.* FROM
		       (SELECT HAK.YYYY,
		              HAK.TERM 
		         FROM HAK_SCHEDULE HAK 
		        WHERE TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN HAK.START_DATE AND HAK.END_DATE
		        AND ROWNUM = 1 ) H
		       ) 
		ORDER BY SUB.SUBJECT_NAME
	    ]]> -->
	    
	    <![CDATA[
			select
			      sub.SUBJECT_TRANING_TYPE AS subjectTraningType,
				  sub.YYYY AS year,
			      sub.TERM AS term,
			      sub.SUBJECT_CODE AS subjectCode,
			      sub.CLASS AS subClass,
			      sub.SUBJECT_NAME AS subjectName,
			      sub.SUBJECT_TYPE AS subjectType,
			      CASE
			       		WHEN sub.ONLINE_TYPE IN ('104','105') THEN 'FLIPPED'
			       		WHEN sub.ONLINE_TYPE = '102' THEN 'BLENDED'
			       		WHEN sub.ONLINE_TYPE = '101' THEN 'ONLINE'
			         ELSE  'NONE'
			   	 END onlineType,
			       (
			      SELECT SUM(1) FROM LMS_LESSON LES			      	 
			      	WHERE  EXISTS (SELECT 1 FROM COM_MEMBER MEM WHERE LES.MEM_SEQ = MEM.MEM_SEQ 
                          AND MEM.DELETE_YN = 'N' 
                          AND MEM.OUT_YN = 'N' )
                    AND LES.DELETE_YN = 'N'
			      	AND LES.LEC_STATUS = 'A'
			      	AND LES.YYYY = SUB.YYYY
			      	AND LES.TERM = SUB.TERM
			      	AND LES.SUBJECT_CODE = SUB.SUBJECT_CODE
			      	AND LES.CLASS = SUB.CLASS
			      ) AS STU_CNT
			  from lms_subject sub,
			  lms_dept_cdp_mapping cdp
			  where 1 = 1
			  and sub.department_no = cdp.dept_no
			  and sub.SUBJECT_TRANING_TYPE = 'OFF'
			  and sub.DELETE_YN = 'N'
			  and cdp.MEM_SEQ = #{sessionMemSeq}
			  
			   AND 
		       (
		         SUB.YYYY, 
		         SUB.TERM
		       ) 
		       IN (SELECT H.* FROM
		       (SELECT HAK.YYYY,
		              HAK.TERM 
		         FROM HAK_SCHEDULE HAK 
		        WHERE TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN TO_CHAR(TO_DATE(HAK.START_DATE,'YYYYMMDD')-5,'YYYYMMDD') AND TO_CHAR(TO_DATE(HAK.END_DATE,'YYYYMMDD')+14,'YYYYMMDD')
		         ) H
		       ) 
		ORDER BY SUB.SUBJECT_NAME
	    ]]>

	</select>
	
	<select id="getOjtAunuriSubjectInsHSkillCnt" parameterType="kr.co.gocle.ifx.vo.AunuriMemberVO" resultType="Integer">
		/**	kr.co.gocle.ifx.service.impl.IfxMapper.getOjtAunuriSubjectInsHSkillCnt	*/
	    <![CDATA[
			 select
			     count(*)  
			  from lms_subject sub,
			  lms_subj_ins_mapping ins
			  where 1 = 1
			  and sub.YYYY = ins.YYYY
			  and sub.TERM = ins.TERM
			  and sub.SUBJECT_CODE = ins.SUBJECT_CODE
			  and sub.CLASS = ins.CLASS
			  and sub.SUBJECT_TRANING_TYPE = 'OJT'
			  and sub.SUBJECT_TYPE = 'HSKILL'
			  and sub.DELETE_YN = 'N'
			  and ins.DELETE_YN = 'N'
			  and ins.MEM_SEQ = #{sessionMemSeq}
			   AND 
		       (
		         SUB.YYYY, 
		         SUB.TERM
		       ) 
		       IN (SELECT H.* FROM
		       (SELECT HAK.YYYY,
		              HAK.TERM 
		         FROM HAK_SCHEDULE HAK 
		        WHERE TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN HAK.START_DATE AND HAK.END_DATE
		        AND ROWNUM = 1 ) H
		       ) 
		ORDER BY SUB.SUBJECT_NAME	    			
	    ]]>

	</select>
	
	<select id="getOjtAunuriSubjectInsOjtCnt" parameterType="kr.co.gocle.ifx.vo.AunuriMemberVO" resultType="Integer">
		/**	kr.co.gocle.ifx.service.impl.IfxMapper.getOjtAunuriSubjectInsHSkillCnt	*/
	    <![CDATA[
			 select
			     count(*)  
			  from lms_subject sub,
			  lms_subj_ins_mapping ins
			  where 1 = 1
			  and sub.YYYY = ins.YYYY
			  and sub.TERM = ins.TERM
			  and sub.SUBJECT_CODE = ins.SUBJECT_CODE
			  and sub.CLASS = ins.CLASS
			  and sub.SUBJECT_TRANING_TYPE = 'OJT'
			  and sub.DELETE_YN = 'N'
			  and ins.DELETE_YN = 'N'
			  and ins.MEM_SEQ = #{sessionMemSeq}
			  and rownum = 1
	    ]]>

	</select>
	
	
	

</mapper>
